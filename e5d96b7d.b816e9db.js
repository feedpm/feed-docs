(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{143:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return i})),a.d(t,"metadata",(function(){return o})),a.d(t,"toc",(function(){return l})),a.d(t,"default",(function(){return b}));var n=a(3),r=a(7),s=(a(0),a(158)),c=a(159),i={id:"store-tutorial",title:"Store",sidebar_label:"Store"},o={unversionedId:"react/training/store-tutorial",id:"react/training/store-tutorial",isDocsHomePage:!1,title:"Store",description:"What is store?",source:"@site/docs/react/training/store.md",slug:"/react/training/store-tutorial",permalink:"/feed-docs/docs/react/training/store-tutorial",editUrl:"https://github.com/feedpm/feed-docs/tree/main/docs/react/training/store.md",version:"current",sidebar_label:"Store",sidebar:"docs",previous:{title:"React HOC",permalink:"/feed-docs/docs/react/training/hoc"},next:{title:"Redux Persist",permalink:"/feed-docs/docs/react/training/persist-store"}},l=[{value:"What is store?",id:"what-is-store",children:[]},{value:"Creating Store",id:"creating-store",children:[]},{value:"Subscribing to stores",id:"subscribing-to-stores",children:[]},{value:"Dispatching Actions",id:"dispatching-actions",children:[]},{value:"API reference",id:"api-reference",children:[{value:"<code>createStore(reducer, [preloadedState], [enhancer])</code>",id:"createstorereducer-preloadedstate-enhancer",children:[]},{value:"<code>getState()</code>",id:"getstate",children:[]},{value:"<code>dispatch(action)</code>",id:"dispatchaction",children:[]},{value:"<code>subscribe(listener)</code>",id:"subscribelistener",children:[]}]}],u={toc:l};function b(e){var t=e.components,i=Object(r.a)(e,["components"]);return Object(s.b)("wrapper",Object(n.a)({},u,i,{components:t,mdxType:"MDXLayout"}),Object(s.b)("h2",{id:"what-is-store"},"What is store?"),Object(s.b)("p",null,"A store is basically just a plain JavaScript object that allows components to share state. In a way, we can think of a store as a database which holds all of the application's state."),Object(s.b)("p",null,"On the most fundamental level, a store encapsulates state. We can easily model this using a ES6 class:"),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-js"},"class Store {\n  constructor(initialState) {\n    this.state = initialState;\n  }\n\n  setState(state) {\n    this.state = state;\n  }\n\n  getState() {\n    return this.state;\n  }\n}\n\nconst store = new Store({});\nexport default store;\n")),Object(s.b)("p",null,"With Flux it is a convention to have multiple stores per application; each store is a singleton object."),Object(s.b)("p",null,"It's important to note that you'll only have a single store in a Redux application. When you want to split your data handling logic, you'll use reducer composition instead of many stores."),Object(s.b)("p",null,"In otherwords, the store can be considered as a singleton object of a Class having the following responsibilities:"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"Holds application state;"),Object(s.b)("li",{parentName:"ul"},"Allows access to state via ",Object(s.b)("a",{parentName:"li",href:"#getstate"},"getState()"),";"),Object(s.b)("li",{parentName:"ul"},"Allows state to be updated via ",Object(s.b)("a",{parentName:"li",href:"#dispatchaction"},"dispatch(action)"),";"),Object(s.b)("li",{parentName:"ul"},"Registers listeners via ",Object(s.b)("a",{parentName:"li",href:"#subscribelistener"},"subscribe(listener)"),";"),Object(s.b)("li",{parentName:"ul"},"Handles unregistering of listeners via the function returned by ",Object(s.b)("a",{parentName:"li",href:"#subscribelistener"},"subscribe(listener)"),".")),Object(s.b)("h2",{id:"creating-store"},"Creating Store"),Object(s.b)("p",null,"To create it, pass your root reducing function to ",Object(s.b)("a",{parentName:"p",href:"#createstorereducer-preloadedstate-enhancer"},"createStore"),"."),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-js"},"import {createStore} from 'redux';\nimport todoApp from './reducers';\nconst store = createStore(todoApp);\n")),Object(s.b)("p",null,"You may optionally specify the initial state as the second argument to ",Object(s.b)("a",{parentName:"p",href:"#createstorereducer-preloadedstate-enhancer"},"createStore"),". This is useful for hydrating the state of the client to match the state of a Redux application running on the server."),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-js"},"const store = createStore(todoApp, window.STATE_FROM_SERVER);\n")),Object(s.b)("h2",{id:"subscribing-to-stores"},"Subscribing to stores"),Object(s.b)("p",null,"React components are data-driven. If we update their state using setState, React re-evaluates the component's render function and updates the rendered DOM structure."),Object(s.b)("p",null,'Hence we need a way to wire up our components to our global store. In some way, components need to be able to "listen" for state changes that occur in our store:'),Object(s.b)("p",null,Object(s.b)("img",{alt:"Store Architecture",src:a(301).default,title:"Store Architecture"})),Object(s.b)("p",null,"An arbitrary number of components can subscribe to state changes that occur in the store. Components can then react to the state change by updating their own state and thus triggering a re-render."),Object(s.b)("h2",{id:"dispatching-actions"},"Dispatching Actions"),Object(s.b)("p",null,"The only way to change the state inside store is to dispatch an action on it."),Object(s.b)("p",null,Object(s.b)("img",{alt:"Dispatch Action",src:a(302).default,title:"Dispatch Action"})),Object(s.b)("h2",{id:"api-reference"},"API reference"),Object(s.b)("h3",{id:"createstorereducer-preloadedstate-enhancer"},Object(s.b)("inlineCode",{parentName:"h3"},"createStore(reducer, [preloadedState], [enhancer])")),Object(s.b)("p",null,"Creates a Redux store that holds the complete state tree of your app. There should only be a single store in your app."),Object(s.b)("h4",{id:"arguments"},"Arguments"),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"reducer")," ",Object(s.b)("em",{parentName:"p"},"(Function)"),": A reducing function that returns the next state tree, given the current state tree and an action to handle."),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"[preloadedState]")," ",Object(s.b)("em",{parentName:"p"},"(any)"),": The initial state. You may optionally specify it to hydrate the state from the server in universal apps, or to restore a previously serialized user session. If you produced reducer with combineReducers, this must be a plain object with the same shape as the keys passed to it. Otherwise, you are free to pass anything that your reducer can understand."),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"[enhancer]")," ",Object(s.b)("em",{parentName:"p"},"(Function)"),": The store enhancer. You may optionally specify it to enhance the store with third-party capabilities such as middleware, time travel, persistence, etc. The only store enhancer that ships with Redux is applyMiddleware()."),Object(s.b)("h3",{id:"getstate"},Object(s.b)("inlineCode",{parentName:"h3"},"getState()")),Object(s.b)("p",null,"Returns the current state tree of your application. It is equal to the last value returned by the store's reducer."),Object(s.b)("h4",{id:"returns"},"Returns"),Object(s.b)("p",null,"(any): The current state tree of your application."),Object(s.b)("h3",{id:"dispatchaction"},Object(s.b)("inlineCode",{parentName:"h3"},"dispatch(action)")),Object(s.b)("p",null,"Dispatches an action. This is the only way to trigger a state change."),Object(s.b)("p",null,"The store's reducing function will be called with the current getState() result and the given action synchronously. Its return value will be considered the next state. It will be returned from getState() from now on, and the change listeners will immediately be notified."),Object(s.b)("h4",{id:"arguments-1"},"Arguments"),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"action")," ",Object(s.b)("em",{parentName:"p"},"(Object)"),": A plain object describing the change that makes sense for your application. Actions are the only way to get data into the store, so any data, whether from the UI events, network callbacks, or other sources such as WebSockets needs to eventually be dispatched as actions. Actions must have a type field that indicates the type of action being performed. Types can be defined as constants and imported from another module."),Object(s.b)("h4",{id:"returns-1"},"Returns"),Object(s.b)("p",null,"(Object): The dispatched action."),Object(s.b)("h3",{id:"subscribelistener"},Object(s.b)("inlineCode",{parentName:"h3"},"subscribe(listener)")),Object(s.b)("p",null,"Adds a change listener. It will be called any time an action is dispatched, and some part of the state tree may potentially have changed. You may then call getState() to read the current state tree inside the callback."),Object(s.b)("p",null,"To unsubscribe the change listener, invoke the function returned by subscribe."),Object(s.b)("h4",{id:"arguments-2"},"Arguments"),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"listener")," ",Object(s.b)("em",{parentName:"p"},"(Function)"),": The callback to be invoked any time an action has been dispatched, and the state tree might have changed. You may call getState() inside this callback to read the current state tree. It is reasonable to expect that the store's reducer is a pure function, so you may compare references to some deep path in the state tree to learn whether its value has changed."),Object(s.b)("h4",{id:"returns-2"},"Returns"),Object(s.b)("p",null,"(Function): A function that unsubscribes the change listener."),Object(s.b)(c.a,{name:"Tessy Thomas",date:"07/05/2020",mdxType:"EditedBy"}))}b.isMDXComponent=!0},158:function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return h}));var n=a(0),r=a.n(n);function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){s(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=r.a.createContext({}),u=function(e){var t=r.a.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},b=function(e){var t=u(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},p=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,s=e.originalType,c=e.parentName,l=o(e,["components","mdxType","originalType","parentName"]),b=u(a),p=n,h=b["".concat(c,".").concat(p)]||b[p]||d[p]||s;return a?r.a.createElement(h,i(i({ref:t},l),{},{components:a})):r.a.createElement(h,i({ref:t},l))}));function h(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=a.length,c=new Array(s);c[0]=p;var i={};for(var o in t)hasOwnProperty.call(t,o)&&(i[o]=t[o]);i.originalType=e,i.mdxType="string"==typeof e?e:n,c[1]=i;for(var l=2;l<s;l++)c[l]=a[l];return r.a.createElement.apply(null,c)}return r.a.createElement.apply(null,a)}p.displayName="MDXCreateElement"},159:function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(1),c=a.n(s),i=a(56),o=a.n(i),l={name:c.a.string.isRequired,updated:c.a.string,date:c.a.string.isRequired},u=function(e){var t=e.name,a=e.updated,n=e.date;return r.a.createElement("div",{className:o.a.editedBy},r.a.createElement("div",{className:o.a.block+" "+(n?"":o.a.single)},r.a.createElement("span",{className:o.a.label},"Author"),r.a.createElement("span",{className:o.a.value},t)),a?r.a.createElement("div",{className:o.a.block+" "+(n?o.a.double:"")},r.a.createElement("span",{className:o.a.label},"Updated by"),r.a.createElement("span",{className:o.a.value},a)):null,r.a.createElement("div",{className:o.a.block+" "+(n?o.a.double:"")},r.a.createElement("span",{className:o.a.label},"On"),r.a.createElement("span",{className:o.a.value},n)))};u.propTypes=l,u.defaultProps={updated:""},t.a=u},301:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/react-stores-readme-store-199b86acbc832089022e22afd7350f04.png"},302:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/store-dispatch-subscribe-18134b075570905b557dce840c1f43b9.png"}}]);